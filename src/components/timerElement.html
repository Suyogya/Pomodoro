<template id="timerElement">
	<style>
		:host {
			display: inline-block;
			width: 250px;
			height: 100px;
		}

		:host(.inactive) {
			display: none;
		}

		h1 {
			margin: 0px 5px 0px 5px;
			font-size: 450%;
		}

		div {
			display: inline-block;
		}

		#time {
			margin: 0px 15px 0px 15px;
		}

		input {
			display: block;
			font-family: FontAwesome;
			font-size: 200%;
		}
	</style>
	<div id="content">
		<div id="time">
			<h1>00:00</h1>
		</div>
		<div id="button-divs" class="inline">
			<input id="upButton" type="button" value="&#xf0d8"></input>
			<input id="dnButton" type="button" value="&#xf0d7"></input>
		</div>
	</div>
</template>
<script>
	"use strict";

	let importDoc = document.currentScript.ownerDocument;

	System
        .import("js/timer.js")
        .then(function (module){
			let Timer = module.Timer;

			class PomodoroTimeElement extends HTMLElement{

				constructor(){
					super();
				}

				createdCallback(){
					var template = importDoc.querySelector('template#timerElement');
					this.shadow = this.createShadowRoot();
					this.shadow.appendChild(importDoc.importNode(template.content, true));

					this._timer = new Timer();

					this.timer.subscribe(this.updateTime, this, 'currentTime');

					this.timer.totalTime = 100;
					this.timer.start();

				}

				get timer(){
					return this._timer;
				}

				updateTime(timeInSeconds){
					let getTwoDigits = (num) => ('0' + num).slice(-2);

					let min = getTwoDigits(Math.floor((timeInSeconds%3600)/60));
					let sec = getTwoDigits(timeInSeconds%60);

					let time = min + ':' + sec;

					this.shadow.querySelector('h1').innerHTML = time;
				}
			}

			document.registerElement('pomodoro-timer-element', PomodoroTimeElement);
	});

</script>